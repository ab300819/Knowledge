## **19.4 systemd-journald.service 简介**

### **19.4.1 使用 journalctl 查看登陆信息**

```
[root@study ~]# journalctl [-nrpf] [--since TIME] [--until TIME] _optional
選項與參數：
預設會秀出全部的 log 內容，從舊的輸出到最新的訊息
-n  ：秀出最近的幾行的意思～找最新的資訊相當有用
-r  ：反向輸出，從最新的輸出到最舊的資料
-p  ：秀出後面所接的訊息重要性排序！請參考前一小節的 rsyslogd 資訊
-f  ：類似 tail -f 的功能，持續顯示 journal 日誌的內容(即時監測時相當有幫助！)
--since --until：設定開始與結束的時間，讓在該期間的資料輸出而已
_SYSTEMD_UNIT=unit.service ：只輸出 unit.service 的資訊而已
_COMM=bash ：只輸出與 bash 有關的資訊
_PID=pid   ：只輸出 PID 號碼的資訊
_UID=uid   ：只輸出 UID 為 uid 的資訊
SYSLOG_FACILITY=[0-23] ：使用 syslog.h 規範的服務相對序號來呼叫出正確的資料！

範例一：秀出目前系統中所有的 journal 日誌資料
[root@study ~]# journalctl
-- Logs begin at Mon 2015-08-17 18:37:52 CST, end at Wed 2015-08-19 00:01:01 CST. --
Aug 17 18:37:52 study.centos.vbird systemd-journal[105]: Runtime journal is using 8.0M (max 
 142.4M, leaving 213.6M of free 1.3G, current limit 142.4M).
Aug 17 18:37:52 study.centos.vbird systemd-journal[105]: Runtime journal is using 8.0M (max
 142.4M, leaving 213.6M of free 1.3G, current limit 142.4M).
Aug 17 18:37:52 study.centos.vbird kernel: Initializing cgroup subsys cpuset
Aug 17 18:37:52 study.centos.vbird kernel: Initializing cgroup subsys cpu
.....(中間省略).....
Aug 19 00:01:01 study.centos.vbird run-parts(/etc/cron.hourly)[19268]: finished 0anacron
Aug 19 00:01:01 study.centos.vbird run-parts(/etc/cron.hourly)[19270]: starting 0yum-hourly.cron
Aug 19 00:01:01 study.centos.vbird run-parts(/etc/cron.hourly)[19274]: finished 0yum-hourly.cron
# 從這次開機以來的所有資料都會顯示出來！透過 less 一頁頁翻動給管理員查閱！資料量相當大！

範例二：(1)僅顯示出 2015/08/18 整天以及(2)僅今天及(3)僅昨天的日誌資料內容
[root@study ~]# journalctl --since "2015-08-18 00:00:00" --until "2015-08-19 00:00:00"
[root@study ~]# journalctl --since today
[root@study ~]# journalctl --since yesterday --until today

範例三：只找出 crond.service 的資料，同時只列出最新的 10 筆即可
[root@study ~]# journalctl _SYSTEMD_UNIT=crond.service -n 10

範例四：找出 su, login 執行的登錄檔，同時只列出最新的 10 筆即可
[root@study ~]# journalctl _COMM=su _COMM=login -n 10

範例五：找出訊息嚴重等級為錯誤 (error) 的訊息！
[root@study ~]# journalctl -p err

範例六：找出跟登錄服務 (auth, authpriv) 有關的登錄檔訊息
[root@study ~]# journalctl SYSLOG_FACILITY=4 SYSLOG_FACILITY=10
# 更多關於 syslog_facility 的資料，請參考 18.2.1 小節的內容囉！
```

### **18.4.2 `logger` 命令的使用**

```
[root@study ~]# logger [-p 服務名稱.等級] "訊息"
選項與參數：
服務名稱.等級 ：這個項目請參考 rsyslogd 的本章後續小節的介紹；

範例一：指定一下，讓 dmtsai 使用 logger 來傳送資料到登錄檔內
[root@study ~]# logger -p user.info "I will check logger command"
[root@study ~]# journalctl SYSLOG_FACILITY=1 -n 3
-- Logs begin at Mon 2015-08-17 18:37:52 CST, end at Wed 2015-08-19 18:03:17 CST. --
Aug 19 18:01:01 study.centos.vbird run-parts(/etc/cron.hourly)[29710]: starting 0yum-hourly.cron
Aug 19 18:01:01 study.centos.vbird run-parts(/etc/cron.hourly)[29714]: finished 0yum-hourly.cron
Aug 19 18:03:17 study.centos.vbird dmtsai[29753]: I will check logger command
```