## **9.2. Linux 系统常见的压缩命令**

```
*.Z         compress 程式壓縮的檔案；
*.zip       zip 程式壓縮的檔案；
*.gz        gzip 程式壓縮的檔案；
*.bz2       bzip2 程式壓縮的檔案；
*.xz        xz 程式壓縮的檔案；
*.tar       tar 程式打包的資料，並沒有壓縮過；
*.tar.gz    tar 程式打包的檔案，其中並且經過 gzip 的壓縮
*.tar.bz2   tar 程式打包的檔案，其中並且經過 bzip2 的壓縮
*.tar.xz    tar 程式打包的檔案，其中並且經過 xz 的壓縮
```

### **9.2.1 gzip, zcat/zmore/zless/zgrep**

#压缩

```
[root@www ~]# gzip [-cdtv#] 档名
[root@www ~]# zcat 档名.gz
选项与参数：
-c  ：将压缩的数据输出到萤幕上，可透过数据流重导向来处理；
-d  ：解压缩的参数；
-t  ：可以用来检验一个压缩档的一致性～看看文件有无错误；
-v  ：可以显示出原文件/压缩文件的压缩比等资讯；
-#  ：压缩等级，-1 最快，但是压缩比最差、-9 最慢，但是压缩比最好！默认是 -6
```

#例子

```
範例一：找出 /etc 底下 (不含子目錄) 容量最大的檔案，並將它複製到 /tmp ，然後以 gzip 壓縮
[dmtsai@study ~]$ ls -ldSr /etc/*   # 忘記選項意義？請自行 man 囉！
.....(前面省略).....
-rw-r--r--.  1 root root    25213 Jun 10  2014 /etc/dnsmasq.conf
-rw-r--r--.  1 root root    69768 May  4 17:55 /etc/ld.so.cache
-rw-r--r--.  1 root root   670293 Jun  7  2013 /etc/services

[dmtsai@study ~]$ cd /tmp 
[dmtsai@study tmp]$ cp /etc/services .
[dmtsai@study tmp]$ gzip -v services
services:        79.7% -- replaced with services.gz
[dmtsai@study tmp]$ ll /etc/services /tmp/services*
-rw-r--r--. 1 root   root   670293 Jun  7  2013 /etc/services
-rw-r--r--. 1 dmtsai dmtsai 136088 Jun 30 18:40 /tmp/services.gz

範例二：由於 services 是文字檔，請將範例一的壓縮檔的內容讀出來！
[dmtsai@study tmp]$ zcat services.gz
# 由於 services 這個原本的檔案是是文字檔，因此我們可以嘗試使用 zcat/zmore/zless 去讀取！
# 此時螢幕上會顯示 servcies.gz 解壓縮之後的原始檔案內容！

範例三：將範例一的檔案解壓縮
[dmtsai@study tmp]$ gzip -d services.gz
# 鳥哥不要使用 gunzip 這個指令，不好背！使用 gzip -d 來進行解壓縮！
# 與 gzip 相反， gzip -d 會將原本的 .gz 刪除，回復到原本的 services 檔案。

範例四：將範例三解開的 services 用最佳的壓縮比壓縮，並保留原本的檔案
[dmtsai@study tmp]$ gzip -9 -c services > services.gz

範例五：由範例四再次建立的 services.gz 中，找出 http 這個關鍵字在哪幾行？
[dmtsai@study tmp]$ zgrep -n 'http' services.gz
14:#       http://www.iana.org/assignments/port-numbers
89:http            80/tcp          www www-http    # WorldWideWeb HTTP
90:http            80/udp          www www-http    # HyperText Transfer Protocol
.....(底下省略).....
```

### **9.2.2 bzip2, bzcat/bzmore/bzless/bzgrep**

压缩
```
[dmtsai@study ~]$ bzip2 [-cdkzv#] 檔名
[dmtsai@study ~]$ bzcat 檔名.bz2
選項與參數：
-c  ：將壓縮的過程產生的資料輸出到螢幕上！
-d  ：解壓縮的參數
-k  ：保留原始檔案，而不會刪除原始的檔案喔！
-z  ：壓縮的參數 (預設值，可以不加)
-v  ：可以顯示出原檔案/壓縮檔案的壓縮比等資訊；
-#  ：與 gzip 同樣的，都是在計算壓縮比的參數， -9 最佳， -1 最快！

範例一：將剛剛 gzip 範例留下來的 /tmp/services 以 bzip2 壓縮
[dmtsai@study tmp]$ bzip2 -v services
  services:  5.409:1,  1.479 bits/byte, 81.51% saved, 670293 in, 123932 out.
[dmtsai@study tmp]$ ls -l services*
-rw-r--r--. 1 dmtsai dmtsai 123932 Jun 30 18:40 services.bz2
-rw-rw-r--. 1 dmtsai dmtsai 135489 Jun 30 18:46 services.gz
# 此時 services 會變成 services.bz2 之外，你也可以發現 bzip2 的壓縮比要較 gzip 好喔！！
# 壓縮率由 gzip 的 79% 提升到 bzip2 的 81% 哩！

範例二：將範例一的檔案內容讀出來！
[dmtsai@study tmp]$ bzcat services.bz2

範例三：將範例一的檔案解壓縮
[dmtsai@study tmp]$ bzip2 -d services.bz2

範例四：將範例三解開的 services 用最佳的壓縮比壓縮，並保留原本的檔案
[dmtsai@study tmp]$ bzip2 -9 -c services > services.bz2
```

### **9.2.3 xz, xzcat/xzmore/xzless/xzgrep**

```
[dmtsai@study ~]$ xz [-dtlkc#] 檔名
[dmtsai@study ~]$ xcat 檔名.xz
選項與參數：
-d  ：就是解壓縮啊！
-t  ：測試壓縮檔的完整性，看有沒有錯誤
-l  ：列出壓縮檔的相關資訊
-k  ：保留原本的檔案不刪除～
-c  ：同樣的，就是將資料由螢幕上輸出的意思！
-#  ：同樣的，也有較佳的壓縮比的意思！

範例一：將剛剛由 bzip2 所遺留下來的 /tmp/services 透過 xz 來壓縮！
[dmtsai@study tmp]$ xz -v services
services (1/1)
  100 %        97.3 KiB / 654.6 KiB = 0.149

[dmtsai@study tmp]$ ls -l services*
-rw-rw-r--. 1 dmtsai dmtsai 123932 Jun 30 19:09 services.bz2
-rw-rw-r--. 1 dmtsai dmtsai 135489 Jun 30 18:46 services.gz
-rw-r--r--. 1 dmtsai dmtsai  99608 Jun 30 18:40 services.xz
# 各位觀眾！看到沒有啊！！容量又進一步下降的更多耶！好棒的壓縮比！

範例二：列出這個壓縮檔的資訊，然後讀出這個壓縮檔的內容
[dmtsai@study tmp]$ xz -l services.xz
Strms  Blocks   Compressed Uncompressed  Ratio  Check   Filename
    1       1     97.3 KiB    654.6 KiB  0.149  CRC64   services.xz
# 竟然可以列出這個檔案的壓縮前後的容量，真是太人性化了！這樣觀察就方便多了！

[dmtsai@study tmp]$ xzcat services.xz

範例三：將他解壓縮吧！
[dmtsai@study tmp]$ xz -d services.xz

範例四：保留原檔案的檔名，並且建立壓縮檔！
[dmtsai@study tmp]$ xz -k services
```